

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Reference &mdash; Drystal v1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Drystal v1.1 documentation" href="index.html"/>
        <link rel="next" title="Tutorials" href="tutorials.html"/>
        <link rel="prev" title="Welcome to Drystal’s website!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Drystal
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#engine">Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#callbacks">Callbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#event">Event</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Callbacks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#graphics">Graphics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#window">Window</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surface">Surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drawing-primitives">Drawing primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blending">Blending</a></li>
<li class="toctree-l3"><a class="reference internal" href="#camera">Camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buffer">Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shader">Shader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#post-processing">Post processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#colors">Colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sprite">Sprite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#font-rendering">Font rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#particle-system">Particle System</a></li>
<li class="toctree-l2"><a class="reference internal" href="#physics">Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#shape">Shape</a></li>
<li class="toctree-l3"><a class="reference internal" href="#body">Body</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mousejoint">MouseJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ropejoint">RopeJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distancejoint">DistanceJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#revolutejoint">RevoluteJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prismaticjoint">PrismaticJoint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#audio">Audio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#music">Music</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sound">Sound</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#storage">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web">Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timer">Timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utils">Utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/basics.html">Basics: Tic-tac-toe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#getting-our-first-window">Getting our first window</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#drawing-the-board">Drawing the board</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#drawing-sprites">Drawing sprites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorials/basics.html#loading-the-resources">Loading the resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorials/basics.html#let-s-draw">Let&#8217;s draw!</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#getting-mouse-events">Getting mouse events</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#is-there-a-winner">Is there a winner ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#gameover-screen">Gameover screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#bonus-highlighting-the-tiles">Bonus: Highlighting the tiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorials/basics.html#final-code">Final code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="resources.html#useful-links">Useful links</a><ul>
<li class="toctree-l3"><a class="reference internal" href="resources.html#lua">Lua</a></li>
<li class="toctree-l3"><a class="reference internal" href="resources.html#box2d">Box2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="resources.html#lua-libraries">Lua libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="resources.html#moonscript">Moonscript</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Drystal</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API Reference</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <span class="target" id="module-drystal"></span><div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Drystal API is not stable yet. It is still changing and as it matures some parts are more and more reliable than
others. Unfortunately, it has not sufficient testing in real games, so the API is changing where we think a
change is worth an API break.</p>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#engine" id="id2">Engine</a><ul>
<li><a class="reference internal" href="#callbacks" id="id3">Callbacks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event" id="id4">Event</a><ul>
<li><a class="reference internal" href="#id1" id="id5">Callbacks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphics" id="id6">Graphics</a><ul>
<li><a class="reference internal" href="#window" id="id7">Window</a></li>
<li><a class="reference internal" href="#surface" id="id8">Surface</a></li>
<li><a class="reference internal" href="#drawing-primitives" id="id9">Drawing primitives</a></li>
<li><a class="reference internal" href="#blending" id="id10">Blending</a></li>
<li><a class="reference internal" href="#camera" id="id11">Camera</a></li>
<li><a class="reference internal" href="#buffer" id="id12">Buffer</a></li>
<li><a class="reference internal" href="#shader" id="id13">Shader</a><ul>
<li><a class="reference internal" href="#post-processing" id="id14">Post processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#colors" id="id15">Colors</a></li>
<li><a class="reference internal" href="#sprite" id="id16">Sprite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#font-rendering" id="id17">Font rendering</a></li>
<li><a class="reference internal" href="#particle-system" id="id18">Particle System</a></li>
<li><a class="reference internal" href="#physics" id="id19">Physics</a><ul>
<li><a class="reference internal" href="#shape" id="id20">Shape</a></li>
<li><a class="reference internal" href="#body" id="id21">Body</a></li>
<li><a class="reference internal" href="#mousejoint" id="id22">MouseJoint</a></li>
<li><a class="reference internal" href="#ropejoint" id="id23">RopeJoint</a></li>
<li><a class="reference internal" href="#distancejoint" id="id24">DistanceJoint</a></li>
<li><a class="reference internal" href="#revolutejoint" id="id25">RevoluteJoint</a></li>
<li><a class="reference internal" href="#prismaticjoint" id="id26">PrismaticJoint</a></li>
</ul>
</li>
<li><a class="reference internal" href="#audio" id="id27">Audio</a><ul>
<li><a class="reference internal" href="#music" id="id28">Music</a></li>
<li><a class="reference internal" href="#sound" id="id29">Sound</a></li>
</ul>
</li>
<li><a class="reference internal" href="#storage" id="id30">Storage</a></li>
<li><a class="reference internal" href="#web" id="id31">Web</a></li>
<li><a class="reference internal" href="#timer" id="id32">Timer</a></li>
<li><a class="reference internal" href="#utils" id="id33">Utils</a></li>
</ul>
</div>
<div class="section" id="engine">
<h2><a class="toc-backref" href="#id2">Engine</a><a class="headerlink" href="#engine" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="drystal.stop">
<code class="descclassname">drystal.</code><code class="descname">stop</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the execution of drystal.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.reload">
<code class="descclassname">drystal.</code><code class="descname">reload</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Reloads the current game. This can be useful during the development on your desktop.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">F3 also reloads the game.</p>
</div>
</dd></dl>

<div class="section" id="callbacks">
<h3><a class="toc-backref" href="#id3">Callbacks</a><a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="drystal.init">
<code class="descclassname">drystal.</code><code class="descname">init</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.init" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called after script loading, before the first frame.
You may want to load your assets from here but you can load them before if you prefer.</p>
<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">print</span> <span class="s1">&#39;</span><span class="s">1&#39;</span>
<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">init</span><span class="p">()</span>
   <span class="nb">print</span> <span class="s1">&#39;</span><span class="s">3&#39;</span>
<span class="k">end</span>
<span class="nb">print</span> <span class="s1">&#39;</span><span class="s">2&#39;</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="function">
<dt id="drystal.update">
<code class="descclassname">drystal.</code><code class="descname">update</code><big>(</big><em>dt: float</em><big>)</big><a class="headerlink" href="#drystal.update" title="Permalink to this definition">¶</a></dt>
<dd><p>This functions is called at each frame. The <code class="docutils literal"><span class="pre">dt</span></code> parameter represents the time elapsed since the last update (in seconds).
Use this function to update the game state.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw">
<code class="descclassname">drystal.</code><code class="descname">draw</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called after the <a class="reference internal" href="#drystal.update" title="drystal.update"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.update()</span></code></a> function.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.atexit">
<code class="descclassname">drystal.</code><code class="descname">atexit</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.atexit" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called when the window is closed or when <a class="reference internal" href="#drystal.stop" title="drystal.stop"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.stop()</span></code></a> is called.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.prereload">
<code class="descclassname">drystal.</code><code class="descname">prereload</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.prereload" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before the game is reloaded (by <a class="reference internal" href="#drystal.reload" title="drystal.reload"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.reload()</span></code></a>, by pressing F3 or with livereloading).
You can use it to save the current state of the game inside a global variable, so it will still be accessible after the reload.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.postreload">
<code class="descclassname">drystal.</code><code class="descname">postreload</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.postreload" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the game was reloaded.
You can use it to restore the state of the game.</p>
</dd></dl>

</div>
</div>
<div class="section" id="event">
<h2><a class="toc-backref" href="#id4">Event</a><a class="headerlink" href="#event" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>The event module allows you to know when the mouse is moved, a key or a button is pressed or released, or
when the screen is resized.</div></blockquote>
<dl class="function">
<dt id="drystal.set_relative_mode">
<code class="descclassname">drystal.</code><code class="descname">set_relative_mode</code><big>(</big><em>relative: boolean</em><big>)</big><a class="headerlink" href="#drystal.set_relative_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the relative mode.</p>
<p>Relative mode is when the mouse is hidden and can&#8217;t leave the window/canvas.</p>
</dd></dl>

<div class="section" id="id1">
<h3><a class="toc-backref" href="#id5">Callbacks</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>To receive events, you have to defined some of the following functions.</p>
<dl class="function">
<dt id="drystal.mouse_motion">
<code class="descclassname">drystal.</code><code class="descname">mouse_motion</code><big>(</big><em>x</em>, <em>y</em>, <em>dx</em>, <em>dy</em><big>)</big><a class="headerlink" href="#drystal.mouse_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the mouse is moved. <code class="docutils literal"><span class="pre">dx</span></code> and <code class="docutils literal"><span class="pre">dy</span></code> are difference between the current position and the last one.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.mouse_press">
<code class="descclassname">drystal.</code><code class="descname">mouse_press</code><big>(</big><em>x</em>, <em>y</em>, <em>button: integer</em><big>)</big><a class="headerlink" href="#drystal.mouse_press" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a button (or mouse wheel) is pressed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<em>int</em>) &#8211; X coordinate of the mouse when the button was pressed</li>
<li><strong>y</strong> (<em>int</em>) &#8211; Y coordinate of the mouse when the button was pressed</li>
<li><strong>button</strong> (<em>int</em>) &#8211; <ul>
<li><code class="docutils literal"><span class="pre">drystal.buttons.left</span></code> (= 1),</li>
<li><code class="docutils literal"><span class="pre">drystal.buttons.right</span></code> (= 2),</li>
<li><code class="docutils literal"><span class="pre">drystal.buttons.middle</span></code> (= 3),</li>
<li><code class="docutils literal"><span class="pre">drystal.buttons.wheel_up</span></code> (= 4),</li>
<li>or <code class="docutils literal"><span class="pre">drystal.buttons.wheel_down</span></code> (= 5).</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="drystal.mouse_release">
<code class="descclassname">drystal.</code><code class="descname">mouse_release</code><big>(</big><em>x</em>, <em>y</em>, <em>button: integer</em><big>)</big><a class="headerlink" href="#drystal.mouse_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a button (or mouse wheel) is released.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">button is the same as in <a class="reference internal" href="#drystal.mouse_press" title="drystal.mouse_press"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.mouse_press()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="drystal.key_press">
<code class="descclassname">drystal.</code><code class="descname">key_press</code><big>(</big><em>key</em><big>)</big><a class="headerlink" href="#drystal.key_press" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a key is pressed.
Depending on key repeat system configuration of the player, <a class="reference internal" href="#drystal.key_press" title="drystal.key_press"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.key_press()</span></code></a> can be called multiple
times even if the user did not released the key. <a class="reference internal" href="#drystal.key_release" title="drystal.key_release"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.key_release()</span></code></a> will be called too.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.key_release">
<code class="descclassname">drystal.</code><code class="descname">key_release</code><big>(</big><em>key</em><big>)</big><a class="headerlink" href="#drystal.key_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#drystal.key_press" title="drystal.key_press"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.key_press()</span></code></a> but when a key is released.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.key_text">
<code class="descclassname">drystal.</code><code class="descname">key_text</code><big>(</big><em>unicode_key</em><big>)</big><a class="headerlink" href="#drystal.key_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a key is pressed, <code class="docutils literal"><span class="pre">unicode_key</span></code> is the character generated by the key and the current modifiers.
For example, if <em>shift</em> and <em>d</em> are pressed, <a class="reference internal" href="#drystal.key_text" title="drystal.key_text"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.key_text()</span></code></a> will be called with the parameter <strong>&#8216;D&#8217;</strong>.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.page_resize">
<code class="descclassname">drystal.</code><code class="descname">page_resize</code><big>(</big><em>w</em>, <em>h</em><big>)</big><a class="headerlink" href="#drystal.page_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the browser page is resized. Use this callback to resize the canvas in the fullscreen mode (see <a class="reference internal" href="#drystal.set_fullscreen" title="drystal.set_fullscreen"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.set_fullscreen()</span></code></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">see <a class="reference external" href="http://www.w3schools.com/jsref/prop_win_innerheight.asp">inner window width and height</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="graphics">
<h2><a class="toc-backref" href="#id6">Graphics</a><a class="headerlink" href="#graphics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="window">
<h3><a class="toc-backref" href="#id7">Window</a><a class="headerlink" href="#window" title="Permalink to this headline">¶</a></h3>
<dl class="data">
<dt id="drystal.screen">
<code class="descclassname">drystal.</code><code class="descname">screen</code><a class="headerlink" href="#drystal.screen" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#drystal.screen" title="drystal.screen"><code class="xref lua lua-data docutils literal"><span class="pre">drystal.screen</span></code></a> is the surface representing the window/canvas, which will be blit after execution of the
<a class="reference internal" href="#drystal.draw" title="drystal.draw"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw()</span></code></a> callback.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.current_draw_on">
<code class="descclassname">drystal.</code><code class="descname">current_draw_on</code><a class="headerlink" href="#drystal.current_draw_on" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#drystal.Surface:draw_on" title="drystal.Surface:draw_on"><code class="xref lua lua-meth docutils literal"><span class="pre">Surface:draw_on()</span></code></a></p>
</dd></dl>

<dl class="data">
<dt id="drystal.current_draw_from">
<code class="descclassname">drystal.</code><code class="descname">current_draw_from</code><a class="headerlink" href="#drystal.current_draw_from" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#drystal.Surface:draw_from" title="drystal.Surface:draw_from"><code class="xref lua lua-meth docutils literal"><span class="pre">Surface:draw_from()</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="drystal.resize">
<code class="descclassname">drystal.</code><code class="descname">resize</code><big>(</big><em>width: integer</em>, <em>height: integer</em><big>)</big><a class="headerlink" href="#drystal.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resizes the window (or the canvas in the browser) to the specified dimensions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike some engines, you can resize the window without having to recreate your surfaces or shaders.</p>
</div>
<div class="highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">drystal</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="nb">assert</span><span class="p">(</span><span class="n">drystal</span><span class="p">.</span><span class="n">screen</span><span class="p">.</span><span class="n">w</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span>
<span class="nb">assert</span><span class="p">(</span><span class="n">drystal</span><span class="p">.</span><span class="n">screen</span><span class="p">.</span><span class="n">h</span> <span class="o">==</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="function">
<dt id="drystal.set_fullscreen">
<code class="descclassname">drystal.</code><code class="descname">set_fullscreen</code><big>(</big><em>fullscreen: boolean</em><big>)</big><a class="headerlink" href="#drystal.set_fullscreen" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables or disables the fullscreen mode.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It will make the game fits the whole page in a browser and not use
the true fullscreen mode. We choose this behavior because the escape key will not
be available anymore and it makes less sense to play a game in fullscreen with a browser.
You also need to ensure that there is no border or margin for the canvas in your index.html.</p>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nt">html</span><span class="o">,</span><span class="nt">body</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="k">overflow</span><span class="o">:</span> <span class="k">hidden</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the browser is resized, the canvas is not resized. Call <code class="docutils literal"><span class="pre">drystal.set_fullscreen(true)</span></code> from the callback <a class="reference internal" href="#drystal.page_resize" title="drystal.page_resize"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.page_resize()</span></code></a> to update it.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="drystal.set_title">
<code class="descclassname">drystal.</code><code class="descname">set_title</code><big>(</big><em>title: str</em><big>)</big><a class="headerlink" href="#drystal.set_title" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the title of the window. In the browser, the title of the document is changed.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.show_cursor">
<code class="descclassname">drystal.</code><code class="descname">show_cursor</code><big>(</big><em>show: boolean</em><big>)</big><a class="headerlink" href="#drystal.show_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Decides if the mouse cursor should be hidden or not.</p>
</dd></dl>

</div>
<div class="section" id="surface">
<h3><a class="toc-backref" href="#id8">Surface</a><a class="headerlink" href="#surface" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Surface">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Surface</code><a class="headerlink" href="#drystal.Surface" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Object representing a surface. Surfaces can be drawn on other surfaces (screen included).</div></blockquote>
<dl class="data">
<dt id="drystal.Surface:w">
<code class="descname">w</code><a class="headerlink" href="#drystal.Surface:w" title="Permalink to this definition">¶</a></dt>
<dd><p>Width of the surface.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.Surface:h">
<code class="descname">h</code><a class="headerlink" href="#drystal.Surface:h" title="Permalink to this definition">¶</a></dt>
<dd><p>Height of the surface.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Surface:draw_on">
<code class="descname">draw_on</code><big>(</big><big>)</big> &rarr; Surface<a class="headerlink" href="#drystal.Surface:draw_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this surface as destination/backbuffer (draw method be redirected to this surface instead of screen) for future draws.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the old surface which was used</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="drystal.Surface:draw_from">
<code class="descname">draw_from</code><big>(</big><big>)</big> &rarr; Surface<a class="headerlink" href="#drystal.Surface:draw_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this surface as source for future textured draws (like <a class="reference internal" href="#drystal.draw_sprite" title="drystal.draw_sprite"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw_sprite()</span></code></a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the old surface which was used</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="drystal.Surface:set_filter">
<code class="descname">set_filter</code><big>(</big><em>filter</em><big>)</big><a class="headerlink" href="#drystal.Surface:set_filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filter</strong> &#8211; <ul>
<li><code class="docutils literal"><span class="pre">drystal.filters.nearest</span></code>,</li>
<li><code class="docutils literal"><span class="pre">drystal.filters.linear</span></code> (= <code class="docutils literal"><span class="pre">drystal.filters.default</span></code>),</li>
<li><code class="docutils literal"><span class="pre">drystal.filters.bilinear</span></code></li>
<li>or <code class="docutils literal"><span class="pre">drystal.filters.trilinear</span></code>.</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A surface is limited to 2048x2048 pixels. We follow the <a class="reference external" href="http://webglstats.com/">WebGL Stats</a> and we use the highest texture size at 100%.</p>
</div>
<dl class="method">
<dt id="drystal.Surface:get_pixel">
<code class="descname">get_pixel</code><big>(</big><em>x</em>, <em>y</em><big>)</big> &rarr; r, g, b, a<a class="headerlink" href="#drystal.Surface:get_pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns red/green/blue/alpha components at given pixel position. Top-right is at (1, 1) and bottom-left is at (surface.w, surface.h) included.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_surface">
<code class="descclassname">drystal.</code><code class="descname">new_surface</code><big>(</big><em>width</em>, <em>height</em><big>)</big><a class="headerlink" href="#drystal.new_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new surface of dimensions (<code class="docutils literal"><span class="pre">width</span></code>, <code class="docutils literal"><span class="pre">height</span></code>).
By default, the surface is transparent.</p>
<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">local</span> <span class="n">surf</span> <span class="o">=</span> <span class="n">drystal</span><span class="p">.</span><span class="n">new_surface</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">surf</span><span class="p">:</span><span class="n">draw_on</span><span class="p">()</span> <span class="c1">-- the following draw function will act on this surface</span>
<span class="n">drystal</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">white&#39;</span><span class="p">)</span>
<span class="n">drystal</span><span class="p">.</span><span class="n">draw_circle</span><span class="p">(</span><span class="n">surf</span><span class="p">.</span><span class="n">w</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">surf</span><span class="p">.</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1">-- draw a white circle inside the surface</span>
<span class="n">drystal</span><span class="p">.</span><span class="n">screen</span><span class="p">:</span><span class="n">draw_on</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="function">
<dt id="drystal.load_surface">
<code class="descclassname">drystal.</code><code class="descname">load_surface</code><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#drystal.load_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a surface from a file.
If the file does not exist or is invalid, <a class="reference internal" href="#drystal.load_surface" title="drystal.load_surface"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.load_surface()</span></code></a> returns (<cite>nil</cite>, error).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use <code class="code lua docutils literal"><span class="name builtin"><span class="pre">assert</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">drystal</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">load_surface</span></span> <span class="literal string single"><span class="pre">'</span></span><span class="literal string"><span class="pre">test.png'</span></span><span class="punctuation"><span class="pre">)</span></span></code> to make sure the surface is loaded.</p>
</div>
</dd></dl>

</div>
<div class="section" id="drawing-primitives">
<h3><a class="toc-backref" href="#id9">Drawing primitives</a><a class="headerlink" href="#drawing-primitives" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="drystal.set_color">
<code class="descclassname">drystal.</code><code class="descname">set_color</code><big>(</big><em>red: float [0-255], green: float [0-255], blue: float [0-255]</em><big>)</big><a class="headerlink" href="#drystal.set_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets current color used by <code class="docutils literal"><span class="pre">draw_*</span></code> functions.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">set_color</code><big>(</big><em>color: table</em><big>)</big></dt>
<dd><p>Sets current color used by <code class="docutils literal"><span class="pre">draw_*</span></code> functions. <code class="docutils literal"><span class="pre">color</span></code> should contains 3 values at keys 1, 2 and 3. For example, <code class="docutils literal"><span class="pre">{128,</span> <span class="pre">128,</span> <span class="pre">128}</span></code> represents gray.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">set_color</code><big>(</big><em>color: string</em><big>)</big></dt>
<dd><p>Sets current color used by <code class="docutils literal"><span class="pre">draw_*</span></code> functions. <code class="docutils literal"><span class="pre">color</span></code> should be either a color name from the <a class="reference internal" href="#drystal.colors" title="drystal.colors"><code class="xref lua lua-data docutils literal"><span class="pre">colors</span></code></a> table or a &#8216;#rgb&#8217; or &#8216;#rrggbb&#8217; CSS-like string.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.set_alpha">
<code class="descclassname">drystal.</code><code class="descname">set_alpha</code><big>(</big><em>alpha: float [0-255]</em><big>)</big><a class="headerlink" href="#drystal.set_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current alpha used by <code class="docutils literal"><span class="pre">draw_*</span></code> functions.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.set_line_width">
<code class="descclassname">drystal.</code><code class="descname">set_line_width</code><big>(</big><em>width: float</em><big>)</big><a class="headerlink" href="#drystal.set_line_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current line width used by <a class="reference internal" href="#drystal.draw_line" title="drystal.draw_line"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw_line()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_background">
<code class="descclassname">drystal.</code><code class="descname">draw_background</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.draw_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the current <a class="reference internal" href="#drystal.current_draw_on" title="drystal.current_draw_on"><code class="xref lua lua-data docutils literal"><span class="pre">current_draw_on</span></code></a> surface.</p>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the following function, <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, <code class="docutils literal"><span class="pre">w</span></code> (width) and <code class="docutils literal"><span class="pre">h</span></code> (height) are floats. Angle are expressed in radians. <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> are screen coordinates.</p>
</div>
<dl class="function">
<dt id="drystal.draw_point">
<code class="descclassname">drystal.</code><code class="descname">draw_point</code><big>(</big><em>x</em>, <em>y</em>, <em>size</em><big>)</big><a class="headerlink" href="#drystal.draw_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a point at the given coordinate and with given size.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_point_tex">
<code class="descclassname">drystal.</code><code class="descname">draw_point_tex</code><big>(</big><em>sourcex</em>, <em>sourcey</em>, <em>x</em>, <em>y</em>, <em>size</em><big>)</big><a class="headerlink" href="#drystal.draw_point_tex" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a textured point at the given coordinate and with given size.
The point will be textured with the surface bound to <a class="reference internal" href="#drystal.current_draw_from" title="drystal.current_draw_from"><code class="xref lua lua-data docutils literal"><span class="pre">current_draw_from</span></code></a>, starting from <code class="docutils literal"><span class="pre">sourcex,</span> <span class="pre">sourcey</span></code> to <code class="docutils literal"><span class="pre">sourcex+64,</span> <span class="pre">sourcey+64</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_line">
<code class="descclassname">drystal.</code><code class="descname">draw_line</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em><big>)</big><a class="headerlink" href="#drystal.draw_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a line between the two given points.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_triangle">
<code class="descclassname">drystal.</code><code class="descname">draw_triangle</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>x3</em>, <em>y3</em><big>)</big><a class="headerlink" href="#drystal.draw_triangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a filled triangle between the three given points.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_surface">
<code class="descclassname">drystal.</code><code class="descname">draw_surface</code><big>(</big><em>ix1</em>, <em>iy1</em>, <em>ix2</em>, <em>iy2</em>, <em>ix3</em>, <em>iy3</em>, <em>ox1</em>, <em>oy1</em>, <em>ox2</em>, <em>oy2</em>, <em>ox3</em>, <em>oy3</em><big>)</big><a class="headerlink" href="#drystal.draw_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a surface (set as <a class="reference internal" href="#drystal.current_draw_from" title="drystal.current_draw_from"><code class="xref lua lua-data docutils literal"><span class="pre">current_draw_from</span></code></a>). The first 6 parameters represent a triangle in the source texture,
the last 6 represent the destination triangle. They can have different sizes to create deformations.</p>
<p>Tinting is possible by using <a class="reference internal" href="#drystal.set_color" title="drystal.set_color"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.set_color()</span></code></a> (255, 255, 255 for no modification).</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_quad">
<code class="descclassname">drystal.</code><code class="descname">draw_quad</code><big>(</big><em>ix1</em>, <em>iy1</em>, <em>ix2</em>, <em>iy2</em>, <em>ix3</em>, <em>iy3</em>, <em>ix4</em>, <em>iy4</em>, <em>ox1</em>, <em>oy1</em>, <em>ox2</em>, <em>oy2</em>, <em>ox3</em>, <em>oy3</em>, <em>ox4</em>, <em>oy4</em><big>)</big><a class="headerlink" href="#drystal.draw_quad" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#drystal.draw_surface" title="drystal.draw_surface"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw_surface()</span></code></a> but with quadrilaterals instead of triangles.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_rect">
<code class="descclassname">drystal.</code><code class="descname">draw_rect</code><big>(</big><em>x</em>, <em>y</em>, <em>w</em>, <em>h</em><big>)</big><a class="headerlink" href="#drystal.draw_rect" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a filled rectangle.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_rect_rotated">
<code class="descclassname">drystal.</code><code class="descname">draw_rect_rotated</code><big>(</big><em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>, <em>angle: float</em><big>)</big><a class="headerlink" href="#drystal.draw_rect_rotated" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a filled rotated rectangle.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_square">
<code class="descclassname">drystal.</code><code class="descname">draw_square</code><big>(</big><em>x</em>, <em>y</em>, <em>w</em>, <em>h</em><big>)</big><a class="headerlink" href="#drystal.draw_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a non-filled rectangle.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_circle">
<code class="descclassname">drystal.</code><code class="descname">draw_circle</code><big>(</big><em>x</em>, <em>y</em>, <em>radius: float</em><big>)</big><a class="headerlink" href="#drystal.draw_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a circle. The coordinate is the position of the center. <code class="docutils literal"><span class="pre">radius</span></code> is expressed in pixel.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function draws a lot of triangles. If possible, include a circle in your spritesheet and draw it with <a class="reference internal" href="#drystal.draw_sprite" title="drystal.draw_sprite"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw_sprite()</span></code></a>.</p>
</div>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_polygon">
<code class="descclassname">drystal.</code><code class="descname">draw_polygon</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>...</em><big>)</big><a class="headerlink" href="#drystal.draw_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a filled polygon.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_polyline">
<code class="descclassname">drystal.</code><code class="descname">draw_polyline</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>...</em><big>)</big><a class="headerlink" href="#drystal.draw_polyline" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a non-filled polygon.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_image">
<code class="descclassname">drystal.</code><code class="descname">draw_image</code><big>(</big><em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>, <em>destx</em>, <em>desty</em><span class="optional">[</span>, <em>destw=w</em><span class="optional">[</span>, <em>desth=h</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.draw_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws an image. It can be resized if <code class="docutils literal"><span class="pre">destw</span></code> or <code class="docutils literal"><span class="pre">desth</span></code> are different than <code class="docutils literal"><span class="pre">w</span></code> and <code class="docutils literal"><span class="pre">h</span></code></p>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_sprite">
<code class="descclassname">drystal.</code><code class="descname">draw_sprite</code><big>(</big><em>sprite: table</em>, <em>x</em>, <em>y</em><span class="optional">[</span>, <em>transform: table</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.draw_sprite" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws a sprite, from the current <a class="reference internal" href="#drystal.Surface:draw_from" title="drystal.Surface:draw_from"><code class="xref lua lua-meth docutils literal"><span class="pre">Surface:draw_from()</span></code></a> surface.</p>
<p>Use <a class="reference internal" href="#drystal.Sprite" title="drystal.Sprite"><code class="xref lua lua-class docutils literal"><span class="pre">Sprite</span></code></a> for easier sprite drawing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sprite</strong> (<em>table</em>) &#8211; must have the fields: x, y, w and h</li>
<li><strong>transform</strong> (<em>table</em>) &#8211; must have the fields: angle, wfactor and hfactor</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">local</span> <span class="n">sprite</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">-- the first image of a 32x32 spritesheet</span>
   <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
   <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
   <span class="n">w</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
   <span class="n">h</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">draw</span><span class="p">()</span>
   <span class="o">...</span>
   <span class="n">drystal</span><span class="p">.</span><span class="n">draw_sprite</span><span class="p">(</span><span class="n">sprite</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="function">
<dt id="drystal.draw_sprite_simple">
<code class="descclassname">drystal.</code><code class="descname">draw_sprite_simple</code><big>(</big><em>sprite: table</em>, <em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.draw_sprite_simple" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="drystal.draw_sprite_rotated">
<code class="descclassname">drystal.</code><code class="descname">draw_sprite_rotated</code><big>(</big><em>sprite: table</em>, <em>x</em>, <em>y</em>, <em>angle: float</em><big>)</big><a class="headerlink" href="#drystal.draw_sprite_rotated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="drystal.draw_sprite_resized">
<code class="descclassname">drystal.</code><code class="descname">draw_sprite_resized</code><big>(</big><em>sprite: table</em>, <em>x</em>, <em>y</em>, <em>w</em>, <em>h</em><big>)</big><a class="headerlink" href="#drystal.draw_sprite_resized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="blending">
<h3><a class="toc-backref" href="#id10">Blending</a><a class="headerlink" href="#blending" title="Permalink to this headline">¶</a></h3>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Images to show the differences</p>
</div>
<dl class="function">
<dt id="drystal.set_blend_mode">
<code class="descclassname">drystal.</code><code class="descname">set_blend_mode</code><big>(</big><em>blend_mode</em><big>)</big><a class="headerlink" href="#drystal.set_blend_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current blend mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>blend_mode</strong> &#8211; <ul>
<li><code class="docutils literal"><span class="pre">drystal.blends.alpha</span></code> (= <code class="docutils literal"><span class="pre">drystal.blends.default</span></code>),</li>
<li><code class="docutils literal"><span class="pre">drystal.blends.add</span></code></li>
<li>or <code class="docutils literal"><span class="pre">drystal.blends.mult</span></code>.</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="camera">
<h3><a class="toc-backref" href="#id11">Camera</a><a class="headerlink" href="#camera" title="Permalink to this headline">¶</a></h3>
<p>The camera can be used the modify position and size of the following draws.</p>
<dl class="data">
<dt id="drystal.drystal.camera.x">
<code class="descclassname">drystal.camera.</code><code class="descname">x</code><big>(</big><em>=0</em><big>)</big><a class="headerlink" href="#drystal.drystal.camera.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the camera (x coordinate).</p>
</dd></dl>

<dl class="data">
<dt id="drystal.drystal.camera.y">
<code class="descclassname">drystal.camera.</code><code class="descname">y</code><big>(</big><em>=0</em><big>)</big><a class="headerlink" href="#drystal.drystal.camera.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the camera (y coordinate).</p>
</dd></dl>

<dl class="data">
<dt id="drystal.drystal.camera.zoom">
<code class="descclassname">drystal.camera.</code><code class="descname">zoom</code><big>(</big><em>=1</em><big>)</big><a class="headerlink" href="#drystal.drystal.camera.zoom" title="Permalink to this definition">¶</a></dt>
<dd><p>Zoom of the camera. Values greater than 1 mean zoom in, less than 1 mean zoom out.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.drystal.camera.angle">
<code class="descclassname">drystal.camera.</code><code class="descname">angle</code><big>(</big><em>=0</em><big>)</big><a class="headerlink" href="#drystal.drystal.camera.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Angle of the camera. You can easily apply a tilt effect with this field.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.drystal.camera.reset">
<code class="descclassname">drystal.camera.</code><code class="descname">reset</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.drystal.camera.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the camera fields to default values.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.drystal.camera.push">
<code class="descclassname">drystal.camera.</code><code class="descname">push</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.drystal.camera.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current camera state. You can then restore it with <a class="reference internal" href="#drystal.drystal.camera.pop" title="drystal.drystal.camera.pop"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.camera.pop()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.drystal.camera.pop">
<code class="descclassname">drystal.camera.</code><code class="descname">pop</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.drystal.camera.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Restores the camera to the previous state.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.drystal.screen2scene">
<code class="descclassname">drystal.</code><code class="descname">screen2scene</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.drystal.screen2scene" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the position of screen coordinates <code class="docutils literal"><span class="pre">(x,</span> <span class="pre">y)</span></code> to scene/camera coordinates.</p>
</dd></dl>

</div>
<div class="section" id="buffer">
<h3><a class="toc-backref" href="#id12">Buffer</a><a class="headerlink" href="#buffer" title="Permalink to this headline">¶</a></h3>
<p>A buffer can <strong>only contain one type of shape</strong> (point, textured point, line, triangle, textured triangle).</p>
<dl class="class">
<dt id="drystal.Buffer">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Buffer</code><a class="headerlink" href="#drystal.Buffer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Buffer:use">
<code class="descname">use</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Buffer:use" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this buffer as current buffer.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Buffer:draw">
<code class="descname">draw</code><big>(</big><span class="optional">[</span><em>dx=0: float</em><span class="optional">[</span>, <em>dy=0: float</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.Buffer:draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw this buffer. <code class="docutils literal"><span class="pre">dx</span></code> and <code class="docutils literal"><span class="pre">dy</span></code> can be used to offset the draw.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Buffer:reset">
<code class="descname">reset</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Buffer:reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all elements from the buffer.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Buffer:upload_and_free">
<code class="descname">upload_and_free</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Buffer:upload_and_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends the buffer to the graphic card and free memory.
If a buffer is freed, you cannot call <a class="reference internal" href="#drystal.Buffer:reset" title="drystal.Buffer:reset"><code class="xref lua lua-meth docutils literal"><span class="pre">Buffer:reset()</span></code></a>, <a class="reference internal" href="#drystal.Buffer:use" title="drystal.Buffer:use"><code class="xref lua lua-meth docutils literal"><span class="pre">Buffer:use()</span></code></a> or
<code class="xref lua lua-func docutils literal"><span class="pre">Buffer.upload_and_free()</span></code> anymore or errors will be thrown.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_buffer">
<code class="descclassname">drystal.</code><code class="descname">new_buffer</code><big>(</big><span class="optional">[</span><em>initial_size: integer</em><span class="optional">]</span><big>)</big> &rarr; Buffer<a class="headerlink" href="#drystal.new_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a buffer of the specified <code class="docutils literal"><span class="pre">initial_size</span></code>. Once the buffer is full, it is resized.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.use_default_buffer">
<code class="descclassname">drystal.</code><code class="descname">use_default_buffer</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.use_default_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells drystal to use the default buffer.</p>
</dd></dl>

</div>
<div class="section" id="shader">
<h3><a class="toc-backref" href="#id13">Shader</a><a class="headerlink" href="#shader" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Shader">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Shader</code><a class="headerlink" href="#drystal.Shader" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Shader:use">
<code class="descname">use</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Shader:use" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this shader for the following draws.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shader:feed">
<code class="descname">feed</code><big>(</big><em>uniform: str</em>, <em>value: float</em><big>)</big><a class="headerlink" href="#drystal.Shader:feed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_shader">
<code class="descclassname">drystal.</code><code class="descname">new_shader</code><big>(</big><span class="optional">[</span><em>vertex: str</em><span class="optional">[</span>, <em>fragment_color: str</em><span class="optional">[</span>, <em>fragment_texture: str</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big> &rarr; Shader<a class="headerlink" href="#drystal.new_shader" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a shader with code specified.
If one of the code is <code class="code lua docutils literal"><span class="keyword constant"><span class="pre">nil</span></span></code>, code of the default shader is used.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.use_default_shader">
<code class="descclassname">drystal.</code><code class="descname">use_default_shader</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.use_default_shader" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells drystal to use the default shader.</p>
</dd></dl>

<div class="section" id="post-processing">
<h4><a class="toc-backref" href="#id14">Post processing</a><a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="drystal.add_postfx">
<code class="descclassname">drystal.</code><code class="descname">add_postfx</code><big>(</big><em>name: str, code: str[, uniforms: table]) -&gt; function | (nil, error</em><big>)</big><a class="headerlink" href="#drystal.add_postfx" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a post processing effect.
The <code class="docutils literal"><span class="pre">code</span></code> parameter must contain a <em>effect</em> function.
Additional uniforms can be declared by the <code class="docutils literal"><span class="pre">uniforms</span></code> parameter.</p>
<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="nb">assert</span><span class="p">(</span><span class="n">drystal</span><span class="p">.</span><span class="n">add_postfx</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">gray&#39;</span><span class="p">,</span> <span class="s">[[</span>
<span class="s">   vec3 effect(sampler2D tex, vec2 coord)</span>
<span class="s">   {</span>
<span class="s">       vec3 texval = texture2D(tex, coord).rgb;</span>
<span class="s">       return mix(texval, vec3((texval.r + texval.g + texval.b) / 3.0), scale);</span>
<span class="s">   }</span>
<span class="s">]]</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;</span><span class="s">scale&#39;</span><span class="p">}))</span>
</pre></div>
</td></tr></table></div>
</dd></dl>

<dl class="function">
<dt id="drystal.postfx">
<code class="descclassname">drystal.</code><code class="descname">postfx</code><big>(</big><em>name: str</em>, <em>uniforms...: floats</em><big>)</big><a class="headerlink" href="#drystal.postfx" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Applies a post processing effect on the current <em>draw on</em> surface. The uniform list must have the same order than in the declaration of the effect.</div></blockquote>
<div class="code highlight-lua"><div class="highlight"><pre><span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">draw</span><span class="p">()</span>
   <span class="o">...</span>
   <span class="n">drystal</span><span class="p">.</span><span class="n">postfx</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">gray&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="colors">
<h3><a class="toc-backref" href="#id15">Colors</a><a class="headerlink" href="#colors" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Color">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Color</code><a class="headerlink" href="#drystal.Color" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Color:rgb">
<code class="descname">rgb</code><big>(</big><big>)</big> &rarr; r, g, b<a class="headerlink" href="#drystal.Color:rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the RGB values of the color. You can also use <code class="docutils literal"><span class="pre">.r</span></code>, <code class="docutils literal"><span class="pre">.g</span></code> and <code class="docutils literal"><span class="pre">.b</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:hsl">
<code class="descname">hsl</code><big>(</big><big>)</big> &rarr; h, s, l<a class="headerlink" href="#drystal.Color:hsl" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the HSL values of the color. You can also use <code class="docutils literal"><span class="pre">.h</span></code>, <code class="docutils literal"><span class="pre">.s</span></code> and <code class="docutils literal"><span class="pre">.l</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:cmyk">
<code class="descname">cmyk</code><big>(</big><big>)</big> &rarr; c, m, y, k<a class="headerlink" href="#drystal.Color:cmyk" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the CMYK values of the color. You can also use <code class="docutils literal"><span class="pre">.c</span></code>, <code class="docutils literal"><span class="pre">.m</span></code>, <code class="docutils literal"><span class="pre">.y</span></code> and <code class="docutils literal"><span class="pre">.k</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:add">
<code class="descname">add</code><big>(</big><em>color</em><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.Color:add" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Color which is the combination of the two colors using the CMYK subtractive color model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also use the <code class="docutils literal"><span class="pre">+</span></code> operator.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:sub">
<code class="descname">sub</code><big>(</big><em>color</em><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.Color:sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Color which is the substraction of the two colors using the CMYK subtractive color model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also use the <code class="docutils literal"><span class="pre">-</span></code> operator.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:mul">
<code class="descname">mul</code><big>(</big><em>color</em><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.Color:mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Color which is the multiplication of the two colors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also use the <code class="docutils literal"><span class="pre">*</span></code> operator.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:darker">
<code class="descname">darker</code><big>(</big><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.Color:darker" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a darker color.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Color:lighter">
<code class="descname">lighter</code><big>(</big><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.Color:lighter" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a lighter color.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_color">
<code class="descclassname">drystal.</code><code class="descname">new_color</code><big>(</big><em>table</em><big>)</big> &rarr; Color<a class="headerlink" href="#drystal.new_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a color with the RGB color model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table</strong> (<em>table</em>) &#8211; must contains the three components: r, g and b.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_color</code><big>(</big><em>'rgb'</em>, <em>r</em>, <em>g</em>, <em>b</em><big>)</big> &rarr; Color</dt>
<dd><p>Creates a color with the RGB color model.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_color</code><big>(</big><em>'hsl'</em>, <em>h</em>, <em>s</em>, <em>l</em><big>)</big> &rarr; Color</dt>
<dd><p>Creates a color with the HSL color model.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_color</code><big>(</big><em>'cmyk'</em>, <em>c</em>, <em>m</em>, <em>y</em>, <em>k</em><big>)</big> &rarr; Color</dt>
<dd><p>Creates a color with the CMYK color model.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.colors">
<code class="descclassname">drystal.</code><code class="descname">colors</code><a class="headerlink" href="#drystal.colors" title="Permalink to this definition">¶</a></dt>
<dd><p>This table contains all of the <a class="reference external" href="http://www.w3.org/TR/css3-color/#svg-color">W3C colors</a>.
You can also create colors from the #rgb or #rrggbb syntax by indexing this table, like so: <code class="docutils literal"><span class="pre">drystal.colors['#F0F']</span></code>.</p>
</dd></dl>

<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">local</span> <span class="n">drystal</span> <span class="o">=</span> <span class="nb">require</span> <span class="s1">&#39;</span><span class="s">drystal&#39;</span>
<span class="kd">local</span> <span class="n">color</span> <span class="o">=</span> <span class="n">drystal</span><span class="p">.</span><span class="n">colors</span><span class="p">.</span><span class="n">green</span>
<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">init</span><span class="p">()</span>
       <span class="n">drystal</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
       <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">press d or l or m or a&#39;</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">draw</span><span class="p">()</span>
       <span class="n">drystal</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
       <span class="n">drystal</span><span class="p">.</span><span class="n">draw_background</span><span class="p">()</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">key_press</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
       <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="s">d&#39;</span> <span class="k">then</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">:</span><span class="n">darker</span><span class="p">()</span>
       <span class="k">end</span>
       <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="s">l&#39;</span> <span class="k">then</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">:</span><span class="n">lighter</span><span class="p">()</span>
       <span class="k">end</span>
       <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="s">m&#39;</span> <span class="k">then</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">color</span> <span class="o">*</span> <span class="n">drystal</span><span class="p">.</span><span class="n">colors</span><span class="p">.</span><span class="n">steelblue</span>
       <span class="k">end</span>
       <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="s">a&#39;</span> <span class="k">then</span>
              <span class="n">color</span> <span class="o">=</span> <span class="n">color</span> <span class="o">+</span> <span class="n">drystal</span><span class="p">.</span><span class="n">colors</span><span class="p">.</span><span class="n">red</span>
       <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="sprite">
<h3><a class="toc-backref" href="#id16">Sprite</a><a class="headerlink" href="#sprite" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Sprite">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Sprite</code><a class="headerlink" href="#drystal.Sprite" title="Permalink to this definition">¶</a></dt>
<dd><dl class="data">
<dt id="drystal.Sprite:source">
<code class="descname">source</code><a class="headerlink" href="#drystal.Sprite:source" title="Permalink to this definition">¶</a></dt>
<dd><p>Source table of the sprite.
It must contain <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, <code class="docutils literal"><span class="pre">w</span></code> and <code class="docutils literal"><span class="pre">h</span></code> fields.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.Sprite:color">
<code class="descname">color</code><big>(</big><em>={255</em>, <em>255</em>, <em>255}</em><big>)</big><a class="headerlink" href="#drystal.Sprite:color" title="Permalink to this definition">¶</a></dt>
<dd><p>Tint of the sprite.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.Sprite:alpha">
<code class="descname">alpha</code><big>(</big><em>=255</em><big>)</big><a class="headerlink" href="#drystal.Sprite:alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Alpha of the sprite.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">x, y</code></dt>
<dd><p>Coordinates on the screen (or any destination surface).</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">w, h</code></dt>
<dd><p>Width and height of the sprite. If this is different than values from <em>source</em>, the sprite will be resized.</p>
</dd></dl>

<dl class="data">
<dt id="drystal.Sprite:angle">
<code class="descname">angle</code><big>(</big><em>=0</em><big>)</big><a class="headerlink" href="#drystal.Sprite:angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotation of the sprite.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Sprite:draw">
<code class="descname">draw</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Sprite:draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws the sprite on the current <em>draw on</em> surface.
You have to set the correct sprite sheet as <em>draw from</em> surface before use this function.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_sprite">
<code class="descclassname">drystal.</code><code class="descname">new_sprite</code><big>(</big><em>source: table</em><span class="optional">[</span>, <em>x=0</em>, <em>y=0</em><span class="optional">[</span>, <em>w=source.w</em>, <em>h=source.h</em><span class="optional">]</span><span class="optional">]</span><big>)</big> &rarr; Sprite<a class="headerlink" href="#drystal.new_sprite" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a sprite.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> (<em>table</em>) &#8211; <p>must contain the following fields:</p>
<ul>
<li>x, y : coordinates where the sprite is located in the <em>draw_from</em> image</li>
<li>w, h : size of the sprite in the <em>draw_from</em> image</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="code highlight-lua"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">local</span> <span class="n">surface</span> <span class="o">=</span> <span class="nb">assert</span><span class="p">(</span><span class="n">drystal</span><span class="p">.</span><span class="n">load_surface</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">spritesheet.png&#39;</span><span class="p">))</span>
<span class="kd">local</span> <span class="n">source</span> <span class="o">=</span> <span class="p">{</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">32</span> <span class="p">}</span>
<span class="kd">local</span> <span class="n">sprite</span> <span class="o">=</span> <span class="n">drystal</span><span class="p">.</span><span class="n">new_sprite</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">sprite</span><span class="p">.</span><span class="n">update</span><span class="o">=</span><span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>   <span class="c1">-- custom field</span>
   <span class="n">self</span><span class="p">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">angle</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">math.pi</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">end</span>
<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">sprite</span><span class="p">:</span><span class="n">update</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="k">end</span>
<span class="k">function</span> <span class="nc">drystal</span><span class="p">.</span><span class="nf">draw</span><span class="p">()</span>
    <span class="o">...</span> <span class="c1">-- draw background, etc</span>
    <span class="n">surface</span><span class="p">:</span><span class="n">draw_from</span><span class="p">()</span>
    <span class="n">sprite</span><span class="p">:</span><span class="n">draw</span><span class="p">()</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="font-rendering">
<h2><a class="toc-backref" href="#id17">Font rendering</a><a class="headerlink" href="#font-rendering" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="drystal.Font">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Font</code><a class="headerlink" href="#drystal.Font" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Font:draw">
<code class="descname">draw</code><big>(</big><em>text: str</em>, <em>x</em>, <em>y</em><span class="optional">[</span>, <em>alignment=drystal.aligns.left</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.Font:draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws <code class="docutils literal"><span class="pre">text</span></code> at the given coordinates.
Supports &#8216;\n&#8217;.
A particular syntax can be used to create some text effects, for example:</p>
<blockquote>
<div><ul class="simple">
<li><code class="code lua docutils literal"><span class="literal string double"><span class="pre">&quot;</span></span><span class="literal string"><span class="pre">test</span> <span class="pre">{r:255|g:0|b:0|!}&quot;</span></span></code> will print the <code class="docutils literal"><span class="pre">!</span></code> in red,</li>
<li><code class="code lua docutils literal"><span class="literal string double"><span class="pre">&quot;</span></span><span class="literal string"><span class="pre">{outline|outg:255|t{nooutline|e}st}&quot;</span></span></code> will print <code class="docutils literal"><span class="pre">test</span></code> with a green outline, except the <code class="docutils literal"><span class="pre">e</span></code>.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alignement</strong> (<em>integer</em>) &#8211; <ul>
<li>if alignment is <code class="docutils literal"><span class="pre">drystal.aligns.left</span></code> (= 1), text is left aligned (default)</li>
<li>if alignment is <code class="docutils literal"><span class="pre">drystal.aligns.center</span></code> (= 2), text is centered around <code class="docutils literal"><span class="pre">x</span></code>.</li>
<li>if alignment is <code class="docutils literal"><span class="pre">drystal.aligns.right</span></code> (= 3), text is right aligned.</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="drystal.Font:draw_plain">
<code class="descname">draw_plain</code><big>(</big><em>text: str</em>, <em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.Font:draw_plain" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#drystal.Font:draw" title="drystal.Font:draw"><code class="xref lua lua-meth docutils literal"><span class="pre">Font:draw()</span></code></a>, except it doesn&#8217;t align nor accept formating.
Use this function for faster text drawing.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Font:sizeof">
<code class="descname">sizeof</code><big>(</big><em>text</em><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.Font:sizeof" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns width and height the text would use if it was drawn on the screen.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Font:sizeof_plain">
<code class="descname">sizeof_plain</code><big>(</big><em>text</em><big>)</big><a class="headerlink" href="#drystal.Font:sizeof_plain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns width and height the text would use if it was drawn on the screen by <a class="reference internal" href="#drystal.Font:draw_plain" title="drystal.Font:draw_plain"><code class="xref lua lua-meth docutils literal"><span class="pre">Font:draw_plain()</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.load_font">
<code class="descclassname">drystal.</code><code class="descname">load_font</code><big>(</big><em>filename: str</em>, <em>size: float) -&gt; Font | (nil</em>, <em>error</em><big>)</big><a class="headerlink" href="#drystal.load_font" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a truetype font (.ttf file) at desired size.</p>
</dd></dl>

</div>
<div class="section" id="particle-system">
<h2><a class="toc-backref" href="#id18">Particle System</a><a class="headerlink" href="#particle-system" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="drystal.System">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">System</code><a class="headerlink" href="#drystal.System" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.System:start">
<code class="descname">start</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.System:start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts emitting over time.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:emit">
<code class="descname">emit</code><big>(</big><span class="optional">[</span><em>amount=1: integer</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.System:emit" title="Permalink to this definition">¶</a></dt>
<dd><p>Emits <code class="docutils literal"><span class="pre">n</span></code> particle(s). This function is useful when the system is paused and you want a fixed number of particle emission at one particular frame. You still need to call <em>update</em> so the particles get updated.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:stop">
<code class="descname">stop</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.System:stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops emitting over time.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:reset">
<code class="descname">reset</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.System:reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all existing particles.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:clone">
<code class="descname">clone</code><big>(</big><big>)</big> &rarr; System<a class="headerlink" href="#drystal.System:clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an exact copy of the system.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:draw">
<code class="descname">draw</code><big>(</big><em>[x=0: float[, y=0: float])</em><big>)</big><a class="headerlink" href="#drystal.System:draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws the particles of the system. <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> can be used as offset.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:update">
<code class="descname">update</code><big>(</big><em>dt: float</em><big>)</big><a class="headerlink" href="#drystal.System:update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the system and emits some particles according to the emission rate if the system is started.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:add_size">
<code class="descname">add_size</code><big>(</big><em>at_lifetime</em>, <em>size</em><big>)</big><a class="headerlink" href="#drystal.System:add_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a size at a desired particle&#8217;s lifetime.
<cite>at_lifetime</cite> is a float between 0 and 1 which indicate when the specified size has to be the current particle size.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_size</code><big>(</big><em>at_lifetime</em>, <em>minsize</em>, <em>maxsize</em><big>)</big></dt>
<dd><p>Adds a random size at a desired particle&#8217;s lifetime.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:add_color">
<code class="descname">add_color</code><big>(</big><em>at_lifetime</em>, <em>r</em>, <em>g</em>, <em>b</em><big>)</big><a class="headerlink" href="#drystal.System:add_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a color at a desired particle&#8217;s lifetime.
<cite>at_lifetime</cite> is a float between 0 and 1 which indicate when the specified color has to be the current particle color.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">add_color</code><big>(</big><em>at_lifetime</em>, <em>minr</em>, <em>maxr</em>, <em>ming</em>, <em>maxg</em>, <em>minb</em>, <em>maxg</em><big>)</big></dt>
<dd><p>Adds a random color at a desired particle&#8217;s lifetime.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:set_texture">
<code class="descname">set_texture</code><big>(</big><em>tex: Surface</em>, <em>sourcex</em>, <em>sourcey</em><big>)</big><a class="headerlink" href="#drystal.System:set_texture" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the texture of the particles. See <a class="reference internal" href="#drystal.draw_point_tex" title="drystal.draw_point_tex"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.draw_point_tex()</span></code></a> for details about <code class="docutils literal"><span class="pre">sourcex</span></code> and <code class="docutils literal"><span class="pre">sourcey</span></code>.
By default, the system doesn&#8217;t have texture, particles will be represented by colored squares.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:set_position">
<code class="descname">set_position</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big><a class="headerlink" href="#drystal.System:set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the position of the system.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:get_position">
<code class="descname">get_position</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.System:get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position of the system.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:set_offset">
<code class="descname">set_offset</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big><a class="headerlink" href="#drystal.System:set_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the maximum position offset of a particle when emitted.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:get_offset">
<code class="descname">get_offset</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.System:get_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position offset of a particle when emitted.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:set_emission_rate">
<code class="descname">set_emission_rate</code><big>(</big><em>frequency: float</em><big>)</big><a class="headerlink" href="#drystal.System:set_emission_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the emission rate of the system (in Hertz).</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:get_emission_rate">
<code class="descname">get_emission_rate</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.System:get_emission_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the emission rate of the system (in Hertz).</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:set_lifetime">
<code class="descname">set_lifetime</code><big>(</big><em>min: float</em><span class="optional">[</span>, <em>max=min: float</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.System:set_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the lifetime of the particles.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.System:get_lifetime">
<code class="descname">get_lifetime</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.System:get_lifetime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the lifetime of the particles.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_system">
<code class="descclassname">drystal.</code><code class="descname">new_system</code><big>(</big><em>x</em>, <em>y</em><span class="optional">[</span>, <em>size=256</em><span class="optional">]</span><big>)</big> &rarr; System<a class="headerlink" href="#drystal.new_system" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Creates a new particle system at given position.
You can specify the default number of particles held by the system with the <code class="docutils literal"><span class="pre">size</span></code> parameter. If the system need to hold more particles, it resizes automatically.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">By default, attributes are initialized with random values. Make sure to call appropriate setters to obtain the desired particle effect.</p>
</div>
</div>
<div class="section" id="physics">
<h2><a class="toc-backref" href="#id19">Physics</a><a class="headerlink" href="#physics" title="Permalink to this headline">¶</a></h2>
<p>Learning how to use <a class="reference external" href="http://box2d.org/">Box2D</a> will help to better understand Drystal&#8217;s physics module.</p>
<dl class="function">
<dt id="drystal.init_physics">
<code class="descclassname">drystal.</code><code class="descname">init_physics</code><big>(</big><em>gravity_x: float</em>, <em>gravity_y: float</em><span class="optional">[</span>, <em>pixels_per_meter</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.init_physics" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#drystal.set_pixels_per_meter" title="drystal.set_pixels_per_meter"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.set_pixels_per_meter()</span></code></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If <a class="reference internal" href="#drystal.init_physics" title="drystal.init_physics"><code class="xref lua lua-func docutils literal"><span class="pre">init_physics()</span></code></a> is not called before other physics functions, errors will occur.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="drystal.update_physics">
<code class="descclassname">drystal.</code><code class="descname">update_physics</code><big>(</big><em>dt: float</em><span class="optional">[</span>, <em>timestep=0.01</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.update_physics" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the world.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.get_gravity">
<code class="descclassname">drystal.</code><code class="descname">get_gravity</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.get_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the gravity of the world.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.set_gravity">
<code class="descclassname">drystal.</code><code class="descname">set_gravity</code><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.set_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the gravity of the world.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.get_pixels_per_meter">
<code class="descclassname">drystal.</code><code class="descname">get_pixels_per_meter</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.get_pixels_per_meter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ratio used to convert coordinates and forces to/from Box2D.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.set_pixels_per_meter">
<code class="descclassname">drystal.</code><code class="descname">set_pixels_per_meter</code><big>(</big><em>pixels_per_meter: float</em><big>)</big><a class="headerlink" href="#drystal.set_pixels_per_meter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the ratio used to convert coordinates and forces to/from Box2D.
For example, if you set the ratio to <code class="docutils literal"><span class="pre">64</span></code>, this means a circle with a radius of 64 will have a radius of 1 meter in the Box2d world.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.on_collision">
<code class="descclassname">drystal.</code><code class="descname">on_collision</code><big>(</big><em>on_begin</em>, <em>on_end</em>, <em>on_presolve</em>, <em>on_postsolve</em><big>)</big><a class="headerlink" href="#drystal.on_collision" title="Permalink to this definition">¶</a></dt>
<dd><p>Hooks some callbacks to the collision listener.</p>
<ul class="simple">
<li><code class="code lua docutils literal"><span class="name"><span class="pre">on_begin</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">body1</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">body2</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">x</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">y</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">normalx</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">normaly</span></span><span class="punctuation"><span class="pre">)</span></span></code></li>
<li><code class="code lua docutils literal"><span class="name"><span class="pre">on_end</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">body1</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">body2</span></span><span class="punctuation"><span class="pre">)</span></span></code></li>
<li><code class="code lua docutils literal"><span class="name"><span class="pre">on_presolve</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">body1</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">body2</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">x</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">y</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">normalx</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">normaly</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="operator"><span class="pre">-&gt;</span></span> <span class="name"><span class="pre">boolean</span></span></code></li>
<li><code class="code lua docutils literal"><span class="name"><span class="pre">on_postsolve</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">body1</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">body2</span></span><span class="punctuation"><span class="pre">)</span></span></code></li>
</ul>
</dd></dl>

<dl class="function">
<dt id="drystal.raycast">
<code class="descclassname">drystal.</code><code class="descname">raycast</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>'any' | 'closest' | 'farthest'</em><big>)</big> &rarr; body, x, y<a class="headerlink" href="#drystal.raycast" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns any body, the closest or the farthest found during a raycast from <code class="docutils literal"><span class="pre">(x1,</span> <span class="pre">y1)</span></code> to <code class="docutils literal"><span class="pre">(x2,</span> <span class="pre">y2)</span></code>.
It also returns the point of collision.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">raycast</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>'all'</em><big>)</big> &rarr; bodies, points</dt>
<dd><p>Returns all the bodies found during a raycast from <code class="docutils literal"><span class="pre">(x1,</span> <span class="pre">y1)</span></code> to <code class="docutils literal"><span class="pre">(x2,</span> <span class="pre">y2)</span></code>.
It also returns the points of collision.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">raycast</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>callback</em><big>)</big> &rarr; body, x, y</dt>
<dd><p><code class="code lua docutils literal"><span class="name"><span class="pre">callback</span></span><span class="punctuation"><span class="pre">(</span></span><span class="name"><span class="pre">body</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">fraction</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">x</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">y</span></span><span class="punctuation"><span class="pre">)</span></span> <span class="operator"><span class="pre">-&gt;</span></span> <span class="name"><span class="pre">float</span></span><span class="punctuation"><span class="pre">,</span></span> <span class="name"><span class="pre">boolean</span></span></code>
The callback should returns a float and a boolean.
The float works like described <a class="reference external" href="http://www.iforce2d.net/b2dtut/world-querying">here</a>.
If the boolean is <cite>false</cite> then the body and position is not kept for the returned values of <cite>raycast</cite>, which means you can select which values you want to return.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.query">
<code class="descclassname">drystal.</code><code class="descname">query</code><big>(</big><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em><big>)</big> &rarr; table<a class="headerlink" href="#drystal.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a table with all bodies contained inside the area defined by <code class="docutils literal"><span class="pre">x1</span></code>, <code class="docutils literal"><span class="pre">y1</span></code>, <code class="docutils literal"><span class="pre">x2</span></code> and <code class="docutils literal"><span class="pre">y2</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.new_shape">
<code class="descclassname">drystal.</code><code class="descname">new_shape</code><big>(</big><em>'box'</em>, <em>width</em>, <em>height</em><span class="optional">[</span>, <em>x=0</em>, <em>y=0</em><span class="optional">]</span><big>)</big> &rarr; Shape<a class="headerlink" href="#drystal.new_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <em>box</em> shape.
The box is centered on x,y which means you have to add an offset of width/2,height/2 during your draws.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_shape</code><big>(</big><em>'circle'</em>, <em>radius</em><span class="optional">[</span>, <em>x=0</em>, <em>y=0</em><span class="optional">]</span><big>)</big> &rarr; Shape</dt>
<dd><p>Creates a <em>circle</em> shape.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_shape</code><big>(</big><em>'chain'</em>, <em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em>, <em>...</em><big>)</big> &rarr; Shape</dt>
<dd><p>Creates a <em>chain</em> shape. The last point will be linked to the first one.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.new_body">
<code class="descclassname">drystal.</code><code class="descname">new_body</code><big>(</big><em>is_dynamic: boolean</em>, <span class="optional">[</span><em>x</em>, <em>y</em>, <span class="optional">]</span><em>shape1</em>, <em>shape2</em>, <em>...</em><big>)</big> &rarr; Body<a class="headerlink" href="#drystal.new_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a body at the given position (or 0, 0) with the given shapes. If <code class="docutils literal"><span class="pre">is_dynamic</span></code> is false, the body will be static.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.new_joint">
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'mouse'</em>, <em>body1</em>, <em>body2</em>, <em>max_force</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; MouseJoint<a class="headerlink" href="#drystal.new_joint" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mouse joint.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'distance'</em>, <em>body1</em>, <em>body2</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; DistanceJoint</dt>
<dd><p>Creates a distance joint.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'rope'</em>, <em>body1</em>, <em>body2</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; RopeJoint</dt>
<dd><p>Creates a rope joint.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'revolute'</em>, <em>body1</em>, <em>body2</em>, <em>anchor1x</em>, <em>anchor1y</em>, <em>anchor2x</em>, <em>anchor2y</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; RevoluteJoint</dt>
<dd><p>Creates a revolute joint.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'gear'</em>, <em>body1</em>, <em>body2</em>, <em>joint1</em>, <em>joint2</em>, <em>ratio</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; GearJoint</dt>
<dd><p>Creates a gear joint. <code class="docutils literal"><span class="pre">joint1</span></code> and <code class="docutils literal"><span class="pre">joint2</span></code> must be either revolute joints or prismatic joints.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">new_joint</code><big>(</big><em>'prismatic'</em>, <em>body1</em>, <em>body2</em>, <em>anchor1x</em>, <em>anchor1y</em>, <em>anchor2x</em>, <em>anchor2y</em>, <em>axisx</em>, <em>axisy</em><span class="optional">[</span>, <em>collide_connected</em><span class="optional">]</span><big>)</big> &rarr; PrismaticJoint</dt>
<dd><p>Creates a prismatic joint.</p>
</dd></dl>

<div class="section" id="shape">
<h3><a class="toc-backref" href="#id20">Shape</a><a class="headerlink" href="#shape" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Shape">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Shape</code><a class="headerlink" href="#drystal.Shape" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Shape:set_density">
<code class="descname">set_density</code><big>(</big><em>density: float</em><big>)</big><a class="headerlink" href="#drystal.Shape:set_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the density of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:get_density">
<code class="descname">get_density</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Shape:get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the density of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:set_restitution">
<code class="descname">set_restitution</code><big>(</big><em>restitution float</em><big>)</big><a class="headerlink" href="#drystal.Shape:set_restitution" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the restitution of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:get_restitution">
<code class="descname">get_restitution</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Shape:get_restitution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the restitution of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:set_friction">
<code class="descname">set_friction</code><big>(</big><em>friction float</em><big>)</big><a class="headerlink" href="#drystal.Shape:set_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the friction of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:get_friction">
<code class="descname">get_friction</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Shape:get_friction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the friction of the shape.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Shape:set_sensor">
<code class="descname">set_sensor</code><big>(</big><em>sensor: boolean</em><big>)</big><a class="headerlink" href="#drystal.Shape:set_sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal"><span class="pre">sensor</span></code> is <code class="docutils literal"><span class="pre">true</span></code>, the shape will not collide but the <code class="docutils literal"><span class="pre">on_collision</span></code> callback will be called.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="body">
<h3><a class="toc-backref" href="#id21">Body</a><a class="headerlink" href="#body" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Body">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Body</code><a class="headerlink" href="#drystal.Body" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Body:set_position">
<code class="descname">set_position</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the position of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_position">
<code class="descname">get_position</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.Body:get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the position of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_angle">
<code class="descname">set_angle</code><big>(</big><em>angle: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angle of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_angle">
<code class="descname">get_angle</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Body:get_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the angle of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_linear_velocity">
<code class="descname">set_linear_velocity</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_linear_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the linear velocity of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_linear_velocity">
<code class="descname">get_linear_velocity</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.Body:get_linear_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear velocity of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_angular_velocity">
<code class="descname">set_angular_velocity</code><big>(</big><em>x: float</em>, <em>y: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_angular_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angular velocity of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_angular_velocity">
<code class="descname">get_angular_velocity</code><big>(</big><big>)</big> &rarr; float, float<a class="headerlink" href="#drystal.Body:get_angular_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the angular velocity of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_linear_damping">
<code class="descname">set_linear_damping</code><big>(</big><em>damping: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_linear_damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the linear damping of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_linear_damping">
<code class="descname">get_linear_damping</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Body:get_linear_damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linear damping of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_angular_damping">
<code class="descname">set_angular_damping</code><big>(</big><em>damping: float</em><big>)</big><a class="headerlink" href="#drystal.Body:set_angular_damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angular damping of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_angular_damping">
<code class="descname">get_angular_damping</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Body:get_angular_damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the angular damping of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_fixed_rotation">
<code class="descname">set_fixed_rotation</code><big>(</big><em>fixed: boolean</em><big>)</big><a class="headerlink" href="#drystal.Body:set_fixed_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes the rotation of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_fixed_rotation">
<code class="descname">get_fixed_rotation</code><big>(</big><big>)</big> &rarr; boolean<a class="headerlink" href="#drystal.Body:get_fixed_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">true</span></code> if the body has fixed rotation.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_active">
<code class="descname">set_active</code><big>(</big><em>active: boolean</em><big>)</big><a class="headerlink" href="#drystal.Body:set_active" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables or disables a body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_bullet">
<code class="descname">set_bullet</code><big>(</big><em>bullet: boolean</em><big>)</big><a class="headerlink" href="#drystal.Body:set_bullet" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks the body as a fast moving object.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:get_mass">
<code class="descname">get_mass</code><big>(</big><big>)</big> &rarr; float<a class="headerlink" href="#drystal.Body:get_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mass of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:set_mass_center">
<code class="descname">set_mass_center</code><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.Body:set_mass_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the mass center.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:apply_force">
<code class="descname">apply_force</code><big>(</big><em>x</em>, <em>y</em><span class="optional">[</span>, <em>x</em>, <em>y</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.Body:apply_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a force (by default, x, y are the body&#8217;s center).</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:apply_linear_impulse">
<code class="descname">apply_linear_impulse</code><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.Body:apply_linear_impulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a linear impulse (by default, x, y are the body&#8217;s center).</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:apply_angular_impulse">
<code class="descname">apply_angular_impulse</code><big>(</big><em>angle</em><big>)</big><a class="headerlink" href="#drystal.Body:apply_angular_impulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a angular impulse.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:apply_torque">
<code class="descname">apply_torque</code><big>(</big><em>torque</em><big>)</big><a class="headerlink" href="#drystal.Body:apply_torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a torque.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:dump">
<code class="descname">dump</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Body:dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints Box2D attributes of the body.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Body:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Body:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the body.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Once the body is destroy, you cannot call any of its functions anymore. Make sure to remove references (<code class="code lua docutils literal"><span class="name"><span class="pre">my_body</span></span> <span class="operator"><span class="pre">=</span></span> <span class="keyword constant"><span class="pre">nil</span></span></code>).</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Associated joints are destroyed too. Calling functions on those joints will throw an error, make sure to remove references (<code class="code lua docutils literal"><span class="name"><span class="pre">my_joint</span></span> <span class="operator"><span class="pre">=</span></span> <span class="keyword constant"><span class="pre">nil</span></span></code>).</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mousejoint">
<h3><a class="toc-backref" href="#id22">MouseJoint</a><a class="headerlink" href="#mousejoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.MouseJoint">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">MouseJoint</code><a class="headerlink" href="#drystal.MouseJoint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.MouseJoint:set_target">
<code class="descname">set_target</code><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#drystal.MouseJoint:set_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the target position of the joint.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.MouseJoint:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.MouseJoint:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the joint.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ropejoint">
<h3><a class="toc-backref" href="#id23">RopeJoint</a><a class="headerlink" href="#ropejoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.RopeJoint">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">RopeJoint</code><a class="headerlink" href="#drystal.RopeJoint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.RopeJoint:set_max_length">
<code class="descname">set_max_length</code><big>(</big><em>max_length: float</em><big>)</big><a class="headerlink" href="#drystal.RopeJoint:set_max_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the maximum length of the joint</p>
</dd></dl>

<dl class="method">
<dt id="drystal.RopeJoint:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.RopeJoint:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the joint.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="distancejoint">
<h3><a class="toc-backref" href="#id24">DistanceJoint</a><a class="headerlink" href="#distancejoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.DistanceJoint">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">DistanceJoint</code><a class="headerlink" href="#drystal.DistanceJoint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.DistanceJoint:set_length">
<code class="descname">set_length</code><big>(</big><em>length: float</em><big>)</big><a class="headerlink" href="#drystal.DistanceJoint:set_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the length of the joint</p>
</dd></dl>

<dl class="method">
<dt id="drystal.DistanceJoint:set_frequency">
<code class="descname">set_frequency</code><big>(</big><em>frequency: float</em><big>)</big><a class="headerlink" href="#drystal.DistanceJoint:set_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the frequency of the joint.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.DistanceJoint:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.DistanceJoint:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the joint.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="revolutejoint">
<h3><a class="toc-backref" href="#id25">RevoluteJoint</a><a class="headerlink" href="#revolutejoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.RevoluteJoint">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">RevoluteJoint</code><a class="headerlink" href="#drystal.RevoluteJoint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.RevoluteJoint:set_angle_limits">
<code class="descname">set_angle_limits</code><big>(</big><em>min</em>, <em>max</em><big>)</big><a class="headerlink" href="#drystal.RevoluteJoint:set_angle_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the angle limits of the joint. If <code class="docutils literal"><span class="pre">min</span></code> equals <code class="docutils literal"><span class="pre">max</span></code>, limits are disabled.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.RevoluteJoint:set_motor_speed">
<code class="descname">set_motor_speed</code><big>(</big><em>speed: float</em><span class="optional">[</span>, <em>maxtorque=20: float</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.RevoluteJoint:set_motor_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the motor speed. If <code class="docutils literal"><span class="pre">speed</span></code> is 0, motor is disabled.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.RevoluteJoint:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.RevoluteJoint:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the joint.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="prismaticjoint">
<h3><a class="toc-backref" href="#id26">PrismaticJoint</a><a class="headerlink" href="#prismaticjoint" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.PrismaticJoint">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">PrismaticJoint</code><a class="headerlink" href="#drystal.PrismaticJoint" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.PrismaticJoint:set_motor_speed">
<code class="descname">set_motor_speed</code><big>(</big><em>speed: float</em><big>)</big><a class="headerlink" href="#drystal.PrismaticJoint:set_motor_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the motor speed.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:set_max_motor_force">
<code class="descname">set_max_motor_force</code><big>(</big><em>force: float</em><big>)</big><a class="headerlink" href="#drystal.PrismaticJoint:set_max_motor_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the maximum motor force.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:set_enable_motor">
<code class="descname">set_enable_motor</code><big>(</big><em>enable: boolean</em><big>)</big><a class="headerlink" href="#drystal.PrismaticJoint:set_enable_motor" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables or disables the motor.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:set_enable_limit">
<code class="descname">set_enable_limit</code><big>(</big><em>enable: boolean</em><big>)</big><a class="headerlink" href="#drystal.PrismaticJoint:set_enable_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables or disables the limit.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:is_limit_enabled">
<code class="descname">is_limit_enabled</code><big>(</big><big>)</big> &rarr; boolean<a class="headerlink" href="#drystal.PrismaticJoint:is_limit_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">true</span></code> if the joint has limit.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:is_motor_enabled">
<code class="descname">is_motor_enabled</code><big>(</big><big>)</big> &rarr; boolean<a class="headerlink" href="#drystal.PrismaticJoint:is_motor_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">true</span></code> if the motor is enabled.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.PrismaticJoint:destroy">
<code class="descname">destroy</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.PrismaticJoint:destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys the joint.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="audio">
<h2><a class="toc-backref" href="#id27">Audio</a><a class="headerlink" href="#audio" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The audio module allows you to play short sounds with the <a class="reference internal" href="#drystal.Sound" title="drystal.Sound"><code class="xref lua lua-class docutils literal"><span class="pre">Sound</span></code></a> class and stream ambiance music
with the <a class="reference internal" href="#drystal.Music" title="drystal.Music"><code class="xref lua lua-class docutils literal"><span class="pre">Music</span></code></a> class.</p>
<p>For each class you can either load the audio data from a file or generate it with a callback function.</p>
</div></blockquote>
<div class="section" id="music">
<h3><a class="toc-backref" href="#id28">Music</a><a class="headerlink" href="#music" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Music">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Music</code><a class="headerlink" href="#drystal.Music" title="Permalink to this definition">¶</a></dt>
<dd><p>Musics are for large audio files, mainly for ambiance musics during the game.</p>
<dl class="method">
<dt id="drystal.Music:play">
<code class="descname">play</code><big>(</big><span class="optional">[</span><em>loop=false: bool</em><span class="optional">[</span>, <em>onend_callback: function</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#drystal.Music:play" title="Permalink to this definition">¶</a></dt>
<dd><p>Plays the music (from the beginning). If <code class="docutils literal"><span class="pre">loop</span></code> is true, the music will loop forever.
<code class="docutils literal"><span class="pre">onend_callback</span></code> is called when the music finishes (and is not called by :stop()).</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Music:set_pitch">
<code class="descname">set_pitch</code><big>(</big><em>pitch: float</em><big>)</big><a class="headerlink" href="#drystal.Music:set_pitch" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the pitch of the music. <code class="docutils literal"><span class="pre">pitch</span></code> must be &gt; 0.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Music:set_volume">
<code class="descname">set_volume</code><big>(</big><em>volume: float</em><big>)</big><a class="headerlink" href="#drystal.Music:set_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the volume of the music. <code class="docutils literal"><span class="pre">volume</span></code> must be &gt;= 0.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Music:pause">
<code class="descname">pause</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Music:pause" title="Permalink to this definition">¶</a></dt>
<dd><p>Pauses the music.</p>
</dd></dl>

<dl class="method">
<dt id="drystal.Music:stop">
<code class="descname">stop</code><big>(</big><big>)</big><a class="headerlink" href="#drystal.Music:stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the music.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.load_music">
<code class="descclassname">drystal.</code><code class="descname">load_music</code><big>(</big><em>filename: str) -&gt; Music | (nil</em>, <em>error</em><big>)</big><a class="headerlink" href="#drystal.load_music" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a music from a file.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only the <a class="reference external" href="https://en.wikipedia.org/wiki/Ogg">Ogg</a> format is available.</p>
</div>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">load_music</code><big>(</big><em>callback: function[, samplesrate=44100: integer]) -&gt; Music | (nil, error</em><big>)</big></dt>
<dd><p>Loads a music according to a callback function generating the music.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.set_music_volume">
<code class="descclassname">drystal.</code><code class="descname">set_music_volume</code><big>(</big><em>volume: float [0-1]</em><big>)</big><a class="headerlink" href="#drystal.set_music_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the global music volume.</p>
</dd></dl>

</div>
<div class="section" id="sound">
<h3><a class="toc-backref" href="#id29">Sound</a><a class="headerlink" href="#sound" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="drystal.Sound">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Sound</code><a class="headerlink" href="#drystal.Sound" title="Permalink to this definition">¶</a></dt>
<dd><p>Sounds are for short audio files like special effects (e.g. a jump, a shot fired or an explosion).</p>
<p>They are loaded directly into memory. So if you want to play longer audio files it is recommended to use <a class="reference internal" href="#drystal.Music" title="drystal.Music"><code class="xref lua lua-class docutils literal"><span class="pre">Music</span></code></a> objects
which stream the music instead of playing it directly.</p>
<dl class="method">
<dt id="drystal.Sound:play">
<code class="descname">play</code><big>(</big><em>[volume=1[, x=0[, y=0[, pitch=1]]]</em><big>)</big><a class="headerlink" href="#drystal.Sound:play" title="Permalink to this definition">¶</a></dt>
<dd><p>Plays the sound at given volume, position and pitch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>volume</strong> (<em>float</em>) &#8211; between 0 and 1</li>
<li><strong>x</strong> (<em>float</em>) &#8211; between -1 and 1 (-1 is full left, 1 is full right)</li>
<li><strong>y</strong> (<em>float</em>) &#8211; between -1 and 1</li>
<li><strong>pitch</strong> (<em>float</em>) &#8211; greater than 0</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.load_sound">
<code class="descclassname">drystal.</code><code class="descname">load_sound</code><big>(</big><em>filename: str) -&gt; Sound | (nil</em>, <em>error</em><big>)</big><a class="headerlink" href="#drystal.load_sound" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a sound from a file. It has to be in <a class="reference external" href="https://en.wikipedia.org/wiki/WAV">WAV</a> format. Only 44100Hz, 8 bits or 16 bits are supported.
If you want to use positional audio, it has to be mono audio.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">load_sound</code><big>(</big><em>callback: function</em>, <em>numsamples: integer) -&gt; Sound | (nil</em>, <em>error</em><big>)</big></dt>
<dd><p>Loads a sound according to a callback function generating the sound.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">drystal.</code><code class="descname">load_sound</code><big>(</big><em>data: table) -&gt; Sound | (nil</em>, <em>error</em><big>)</big></dt>
<dd></dd></dl>

<dl class="function">
<dt id="drystal.set_sound_volume">
<code class="descclassname">drystal.</code><code class="descname">set_sound_volume</code><big>(</big><em>volume: float [0-1]</em><big>)</big><a class="headerlink" href="#drystal.set_sound_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the global sound volume.</p>
</dd></dl>

</div>
</div>
<div class="section" id="storage">
<h2><a class="toc-backref" href="#id30">Storage</a><a class="headerlink" href="#storage" title="Permalink to this headline">¶</a></h2>
<p>In browser, this module uses Javascript&#8217;s localStorage feature. In desktop, it uses files.</p>
<p>Storage is a way to store data for future executions.</p>
<dl class="function">
<dt id="drystal.store">
<code class="descclassname">drystal.</code><code class="descname">store</code><big>(</big><em>key: str</em>, <em>value: table</em><big>)</big><a class="headerlink" href="#drystal.store" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores a table in the storage.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.fetch">
<code class="descclassname">drystal.</code><code class="descname">fetch</code><big>(</big><em>key: str</em><big>)</big> &rarr; table | nil<a class="headerlink" href="#drystal.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the table associated with the given key.</p>
</dd></dl>

<div class="code highlight-lua"><div class="highlight"><pre><span class="n">drystal</span><span class="p">.</span><span class="n">store</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">text</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">wow&#39;</span><span class="p">})</span>
<span class="nb">assert</span><span class="p">(</span><span class="n">drystal</span><span class="p">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">test&#39;</span><span class="p">).</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="s">wow&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Serialization of the table is done by a JSON module.
In the browser, data are stored in the <code class="docutils literal"><span class="pre">localStorage</span></code> from Javascript.</p>
</div>
</div>
<div class="section" id="web">
<h2><a class="toc-backref" href="#id31">Web</a><a class="headerlink" href="#web" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt>
<code class="descname">is_web: boolean</code></dt>
<dd><p>Equals <code class="docutils literal"><span class="pre">true</span></code> if the game is executed inside a browser.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.wget">
<code class="descclassname">drystal.</code><code class="descname">wget</code><big>(</big><em>url: string</em>, <em>filename: string</em>, <em>onload: function</em>, <em>onerror: function</em><big>)</big><a class="headerlink" href="#drystal.wget" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><a class="reference internal" href="#drystal.wget" title="drystal.wget"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.wget()</span></code></a> is not available on the desktop and will throw an error if it is used on the desktop.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="drystal.run_js">
<code class="descclassname">drystal.</code><code class="descname">run_js</code><big>(</big><em>script: str</em><big>)</big><a class="headerlink" href="#drystal.run_js" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><a class="reference internal" href="#drystal.run_js" title="drystal.run_js"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.run_js()</span></code></a> is not available on the desktop and will throw an error if it is used on the desktop.</p>
</div>
</dd></dl>

</div>
<div class="section" id="timer">
<h2><a class="toc-backref" href="#id32">Timer</a><a class="headerlink" href="#timer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="drystal.Timer">
<em class="property">class </em><code class="descclassname">drystal.</code><code class="descname">Timer</code><a class="headerlink" href="#drystal.Timer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="drystal.Timer:update">
<code class="descname">update</code><big>(</big><em>dt: float</em><big>)</big><a class="headerlink" href="#drystal.Timer:update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the timer. <code class="docutils literal"><span class="pre">dt</span></code> is the time elapsed expressed in second, as in <a class="reference internal" href="#drystal.update" title="drystal.update"><code class="xref lua lua-func docutils literal"><span class="pre">drystal.update()</span></code></a>.
If the timer finishes, <code class="xref lua lua-data docutils literal"><span class="pre">finished</span></code> is set to <cite>true</cite>. If <code class="docutils literal"><span class="pre">callback</span></code> is not <code class="code lua docutils literal"><span class="keyword constant"><span class="pre">nil</span></span></code>, it is called.</p>
</dd></dl>

<dl class="data">
<dt>
<code class="descname">finished: boolean</code></dt>
<dd><p>Indicates if the timer is finished or not.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="drystal.new_timer">
<code class="descclassname">drystal.</code><code class="descname">new_timer</code><big>(</big><em>duration: float</em><span class="optional">[</span>, <em>callback</em><span class="optional">]</span><big>)</big> &rarr; Timer<a class="headerlink" href="#drystal.new_timer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new timer with specified duration and callback.</p>
</dd></dl>

<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>You</em> have to update the timer, otherwise it won&#8217;t finish and the callback won&#8217;t be called.</p>
</div>
</div>
<div class="section" id="utils">
<h2><a class="toc-backref" href="#id33">Utils</a><a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="drystal.tojson">
<code class="descclassname">drystal.</code><code class="descname">tojson</code><big>(</big><em>table</em><big>)</big> &rarr; string<a class="headerlink" href="#drystal.tojson" title="Permalink to this definition">¶</a></dt>
<dd><p>Serializes a Lua table into <a class="reference external" href="http://json.org/">JSON</a> formatted string.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.fromjson">
<code class="descclassname">drystal.</code><code class="descname">fromjson</code><big>(</big><em>json: string</em><big>)</big> &rarr; table<a class="headerlink" href="#drystal.fromjson" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <a class="reference external" href="http://json.org/">JSON</a> formatted string back into a Lua table.</p>
</dd></dl>

<dl class="function">
<dt id="drystal.file_exists">
<code class="descclassname">drystal.</code><code class="descname">file_exists</code><big>(</big><em>filename: str</em><big>)</big> &rarr; boolean<a class="headerlink" href="#drystal.file_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">true</span></code> if the file exists.</p>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Drystal’s website!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Jérémy Anger.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'v1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>